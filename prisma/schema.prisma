// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id              Int             @id @default(autoincrement())
  username        String
  email           String          @unique
  password        String
  role            Role            @default(USER)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  tickets         Ticket[]        @relation("Ticket_user")
  assignedTickets Ticket[]        @relation("Ticket_responsible")
  ticketMessages  TicketMessages[]
}

enum Role {
  ADMIN
  USER
}

model Ticket {
  id            String   @id @default(uuid())
  userId        Int
  responsibleId Int?
  title         String
  status        String   @default("new")
  createdAt     DateTime @default(now())
  deleted       DateTime?
  user          User     @relation("Ticket_user", fields: [userId], references: [id])
  responsible   User?    @relation("Ticket_responsible", fields: [responsibleId], references: [id])
  messages      TicketMessages[]
}

model TicketMessages {
  id        Int       @id @default(autoincrement())
  ticketId  String
  userId    Int
  message   String
  createdAt DateTime  @default(now())
  ticket    Ticket    @relation(fields: [ticketId], references: [id])
  user      User      @relation(fields: [userId], references: [id])
}